---
title: "Final Project"
author: ""
date: ""
output: 
  html_document:
    fig_height: 3
    fig_width: 5
---
<!-- Don't edit in between this line and the one below -->
```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments()
```
<!-- Don't edit the material above this line -->

```{r}
Public_UC_Arrests_Noncampus <- read.csv("Public_UC_Arrests_Noncampus.csv")

Public_UC_Arrests_On_campus <- read.csv("Public_UC_Arrests_On_campus.csv")

Public_UC_Arrests_On_campus_Student_Housing_Facilities <- read.csv("Public_UC_Arrests_On_campus_Student_Housing_Facilities.csv")

Public_UC_Criminal_Offenses_Noncampus <- read.csv("Public_UC_Criminal_Offenses_Noncampus.csv")

Public_UC_Criminal_Offenses_On_campus <- read.csv("Public_UC_Criminal_Offenses_On_campus.csv")

Public_UC_Criminal_Offenses_On_campus_Student_Housing_Facilities <- read.csv("Public_UC_Criminal_Offenses_On_campus_Student_Housing_Facilities.csv")

Public_UC_Disciplinary_Actions_Noncampus <- read.csv("Public_UC_Disciplinary_Actions_Noncampus.csv")

Public_UC_Disciplinary_Actions_On_campus <- read.csv("Public_UC_Disciplinary_Actions_On_campus.csv")

Public_UC_Disciplinary_Actions_Student_Housing_Facilities <- read.csv("Public_UC_Disciplinary_Actions_Student_Housing_Facilities.csv")

Public_UC_VAWA_Offenses_Noncampus <- read.csv("Public_UC_VAWA_Offenses_Noncampus.csv")

Public_UC_VAWA_Offenses_On_campus <- read.csv("Public_UC_VAWA_Offenses_On_campus.csv")

Public_UC_VAWA_Offenses_On_campus_Student_Housing_Facilities <- read.csv("Public_UC_VAWA_Offenses_On_campus_Student_Housing_Facilities.csv")
```
```{r}
## Check your .csv file headings
## If the headings have a space, use the following code
## If the headings have a dot, leave this chunk as a comment
 Public_UC_Arrests_Noncampus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Illegal.weapons.possession=`Illegal weapons possession`, Drug.law.violations=`Drug law violations`, Liquor.law.violations=`Liquor law violations`)

 Public_UC_Arrests_On_campus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Illegal.weapons.possession=`Illegal weapons possession`, Drug.law.violations=`Drug law violations`, Liquor.law.violations=`Liquor law violations`)

 Public_UC_Arrests_On_campus_Student_Housing_Facilities %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Illegal.weapons.possession=`Illegal weapons possession`, Drug.law.violations=`Drug law violations`, Liquor.law.violations=`Liquor law violations`)

 Public_UC_Criminal_Offenses_Noncampus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Sex.offenses...Forcible=`Sex offenses - Forcible`, Aggravated.assault=`Aggravated assault`, Motor.vehicle.theft=`Motor vehicle theft`)

 Public_UC_Criminal_Offenses_On_campus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Sex.offenses...Forcible=`Sex offenses - Forcible`, Aggravated.assault=`Aggravated assault`, Motor.vehicle.theft=`Motor vehicle theft`)

 Public_UC_Criminal_Offenses_On_campus_Student_Housing_Facilities %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Sex.offenses...Forcible=`Sex offenses - Forcible`, Aggravated.assault=`Aggravated assault`, Motor.vehicle.theft=`Motor vehicle theft`)

 Public_UC_VAWA_Offenses_Noncampus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Domestic.violence=`Domestic violence`, Dating.violence=`Dating violence`)

 Public_UC_VAWA_Offenses_On_campus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Domestic.violence=`Domestic violence`, Dating.violence=`Dating violence`)

 Public_UC_VAWA_Offenses_On_campus_Student_Housing_Facilities %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Domestic.violence=`Domestic violence`, Dating.violence=`Dating violence`)
 
 Public_UC_Disciplinary_Actions_Noncampus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Illegal.weapons.possession=`Illegal weapons possession`, Drug.law.violations=`Drug law violations`, Liquor.law.violations=`Liquor law violations`)
 
 Public_UC_Disciplinary_Actions_On_campus %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Illegal.weapons.possession=`Illegal weapons possession`, Drug.law.violations=`Drug law violations`, Liquor.law.violations=`Liquor law violations`)
 
 Public_UC_Disciplinary_Actions_Student_Housing_Facilities %>% mutate(Survey.year=`Survey year`, Institution.name=`Institution name`, Institution.size=`Institution Size`, Illegal.weapons.possession=`Illegal weapons possession`, Drug.law.violations=`Drug law violations`, Liquor.law.violations=`Liquor law violations`)
```
```{r}
#Delete columns of crimes we do not want to observe from the criminal offenses data
Public_UC_Criminal_Offenses_Noncampus <- Public_UC_Criminal_Offenses_Noncampus %>%
  subset(select = c(`Survey.year`, `Institution.name`, `Sex.offenses...Forcible`, Robbery, `Aggravated.assault`, Burglary, `Motor.vehicle.theft`, Arson))

Public_UC_Criminal_Offenses_On_campus <- Public_UC_Criminal_Offenses_On_campus %>%
  subset(select = c(`Survey.year`, `Institution.name`, `Sex.offenses...Forcible`, Robbery, `Aggravated.assault`, Burglary, `Motor.vehicle.theft`, Arson))

Public_UC_Criminal_Offenses_On_campus_Student_Housing_Facilities <- Public_UC_Criminal_Offenses_On_campus_Student_Housing_Facilities %>%
  subset(select = c(`Survey.year`, `Institution.name`, `Sex.offenses...Forcible`, Robbery, `Aggravated.assault`, Burglary, `Motor.vehicle.theft`, Arson))
```

```{r}
#Merged datatable
Public_UC_Arrests <- data.frame(year=Public_UC_Arrests_On_campus$Survey.year, name=Public_UC_Arrests_On_campus$Institution.name, size=Public_UC_Arrests_On_campus$Institution.Size, weapon_arrest = (Public_UC_Arrests_On_campus$Illegal.weapons.possession + Public_UC_Arrests_On_campus_Student_Housing_Facilities$Illegal.weapons.possession + Public_UC_Arrests_Noncampus$Illegal.weapons.possession)/Public_UC_Arrests_On_campus$Institution.Size, drug_arrest = (Public_UC_Arrests_On_campus$Drug.law.violations + Public_UC_Arrests_On_campus_Student_Housing_Facilities$Illegal.weapons.possession + Public_UC_Arrests_Noncampus$Illegal.weapons.possession)/Public_UC_Arrests_On_campus$Institution.Size, liquor_arrest = (Public_UC_Arrests_On_campus$Liquor.law.violations + Public_UC_Arrests_On_campus_Student_Housing_Facilities$Liquor.law.violations + Public_UC_Arrests_Noncampus$Liquor.law.violations)/Public_UC_Arrests_On_campus$Institution.Size)

head(Public_UC_Arrests)
```

```{r}
#Filter out UC Hastings due to reporting inconsitencies
Public_UC_Arrests <- Public_UC_Arrests %>%
  filter(name!="University of California-Hastings College of Law")
```

```{r}
#Standardize all three disciplinary action data sets
Public_UC_Disciplinary_Actions_On_campus <-
  Public_UC_Disciplinary_Actions_On_campus %>%
  filter(Institution.name!="University of California-Hastings College of Law")

Public_UC_Disciplinary_Actions_Student_Housing_Facilities <-
  Public_UC_Disciplinary_Actions_Student_Housing_Facilities %>%
  filter(Institution.name!="University of California-Hastings College of Law") %>%
  filter(Survey.year > 2007)

Public_UC_Disciplinary_Actions_Noncampus <-
  Public_UC_Disciplinary_Actions_Noncampus %>%
  filter(Institution.name!="University of California-Hastings College of Law") %>%
  filter(Survey.year > 2007)

```

```{r}
Public_UC_Disciplinary_Actions <- data.frame(year=Public_UC_Disciplinary_Actions_On_campus$Survey.year, name=Public_UC_Disciplinary_Actions_On_campus$Institution.name, size=Public_UC_Disciplinary_Actions_On_campus$Institution.Size, weapon_discipline=(Public_UC_Disciplinary_Actions_On_campus$Illegal.weapons.possession+Public_UC_Disciplinary_Actions_Student_Housing_Facilities$Illegal.weapons.possession+Public_UC_Disciplinary_Actions_Noncampus$Illegal.weapons.possession)/Public_UC_Disciplinary_Actions_On_campus$Institution.Size, drug_discipline=(Public_UC_Disciplinary_Actions_On_campus$Drug.law.violations+Public_UC_Disciplinary_Actions_Student_Housing_Facilities$Drug.law.violations+Public_UC_Disciplinary_Actions_Noncampus$Liquor.law.violations)/Public_UC_Disciplinary_Actions_On_campus$Institution.Size, liquor_discipline=(Public_UC_Disciplinary_Actions_On_campus$Liquor.law.violations+Public_UC_Disciplinary_Actions_Student_Housing_Facilities$Liquor.law.violations+Public_UC_Disciplinary_Actions_Noncampus$Liquor.law.violations)/Public_UC_Disciplinary_Actions_On_campus$Institution.Size)

Public_UC_Disciplinary_Actions
```
